/* regexp-events v1.0.2 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Event=function e(t,n,r){if(classCallCheck(this,e),"string"!=typeof t)throw new Error("Event.type has to be a string");this.type=t,this.args=n||[],this.target=r};function clearListeners(e,t,n){if(n)e.delete(t);else{var r=e.get(t);r.filter(function(e){return!e.isStatic}).forEach(function(e,t){r.splice(r.indexOf(e),1)}),0===r.length&&e.delete(t)}}function isRegExpEqual(e,t){return e instanceof RegExp&&t instanceof RegExp&&t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode}function isBoolean(e){return!0===e||!1===e}function findInArgArray(e,t,n,r){for(var i=0;i<e.length-n;i++)if(t(e[n+i]))return e[n+i];return r}var Emitter=function(){function e(){classCallCheck(this,e),this.suppressEvents=!1}return createClass(e,[{key:"on",value:function(t,n,r,i,o){if(!("string"==typeof t||t instanceof RegExp||t instanceof Event))throw new Error("Emitter.on requires a String, Event or RegExp as the first argument");if("function"!=typeof n)throw new Error("Emitter.on requires a function as the second argument");i=findInArgArray(arguments,isBoolean,2,!1),o=findInArgArray(arguments,function(e){return Number.isFinite(e)||e===1/0},2,1/0),r=findInArgArray(arguments,function(e){return"object"===(void 0===e?"undefined":_typeof(e))},2,void 0);var s=this.eventMap;return s||(s=e.createEventMap(this)),t instanceof Event&&(t=t.type),s.has(t)||s.set(t,[]),s.get(t).push({func:n,ctx:r,times:o,isStatic:i}),this}},{key:"once",value:function(e,t,n,r){return this.on(e,t,1,n,r)}},{key:"off",value:function(e,t,n,r){if(null==e)throw new Error("Emitter.off requires a String or a RegExp as the first argument");if("function"!=typeof t)throw new Error("Emitter.off requires a function as the second argument");r=findInArgArray(arguments,isBoolean,2,!1),n=findInArgArray(arguments,function(e){return"object"===(void 0===e?"undefined":_typeof(e))},2,void 0),e instanceof Event&&(e=e.type);var i=this.eventMap;if(!i)return this;if(i.has(e)||i.set(e,[]),"string"==typeof e){var o=i.get(e);o.forEach(function(e,i){e.func!==t||e.ctx!==n||e.isStatic&&!r||o.splice(i,1)}),0===o.length&&i.delete(e)}else e instanceof RegExp&&i.forEach(function(o,s){s instanceof RegExp&&isRegExpEqual(e,s)&&(o.forEach(function(e,i){e.func!==t||e.ctx!==n||e.isStatic&&!r||o.splice(i,1)}),0===o.length&&i.delete(s))});return this}},{key:"emit",value:function(e){var t=this;if(!this.suppressEvents){var n=this.eventMap,r=void 0;if(!n)return this;for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(e instanceof Event)void 0===(r=e).target&&(r.target=this);else{if("string"!=typeof e)throw new Error("Emitter.emit requires a String or Event as the first argument");r=new Event(e,o,this)}var a=Array.from(r.args).concat([r]);return n.forEach(function(e,n){("string"==typeof r.type&&n===r.type||"string"==typeof r.type&&n instanceof RegExp&&n.test(r.type)||r.type instanceof RegExp&&n instanceof RegExp&&isRegExpEqual(n,r.type))&&e.forEach(function(e){e.func.apply(e.ctx,a),--e.times<=0&&t.off(r.type,e.func,e.ctx,!0)})}),this}}},{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.eventMap;return r?("string"==typeof e?clearListeners(r,e,t):e instanceof Event?clearListeners(r,e.type,t):e instanceof RegExp?Array.from(r).map(function(e){return e[0]}).forEach(function(i){("string"==typeof i&&n&&e.test(i)||i instanceof RegExp&&isRegExpEqual(i,e))&&clearListeners(r,i,t)}):1===arguments.length&&!0===e?r.clear():(!1===e||void 0===e)&&arguments.length<=1&&r.forEach(function(e,t){e.filter(function(e){return!e.isStatic}).forEach(function(t){e.splice(e.indexOf(t),1)}),0===e.length&&r.delete(t)}),this):this}},{key:"count",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.eventMap;if(!n)return 0;if("string"==typeof e)return n.has(e)?n.get(e).length:0;if(e instanceof Event)return n.has(e.type)?n.get(e.type).length:0;if(e instanceof RegExp){var r=0;return n.forEach(function(n,i){("string"==typeof i&&t&&e.test(i)||i instanceof RegExp&&isRegExpEqual(i,e))&&(r+=n.length)}),r}var i=0;return n.forEach(function(e){i+=e.length}),i}},{key:"dispose",value:function(){return e.removeEventMap(this),this}},{key:"eventMap",get:function(){return e.getEventMap(this)}}],[{key:"getEventMap",value:function(e){return(this.events||(this.events=new WeakMap)).get(e)}},{key:"createEventMap",value:function(e){var t=this.events||(this.events=new WeakMap),n=new Map;return t.set(e,n),n}},{key:"removeEventMap",value:function(e){var t=this.events;t&&e&&t.has(e)&&t.delete(e)}}]),e}();exports.Emitter=Emitter,exports.Event=Event;
//# sourceMappingURL=regexp-events.min.js.map

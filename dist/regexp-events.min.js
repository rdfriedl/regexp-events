"use strict";function clearListeners(e,t,n){if(n)e.delete(t);else{var r=e.get(t);r.filter(function(e){return e.removable}).forEach(function(e,t){r.splice(r.indexOf(e),1)}),0===r.length&&e.delete(t)}}function regexpEqual(e,t){return e instanceof RegExp&&t instanceof RegExp&&t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode}function isObjectLike(e){return!!e&&"object"==typeof e}function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike(e)&&objectToString.call(e)==stringTag}function isFunction(e){var t=isObject(e)?objectToString$1.call(e):"";return t==funcTag||t==genTag}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isNil(e){return null==e}Object.defineProperty(exports,"__esModule",{value:!0});var classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Event=function e(t,n,r){classCallCheck(this,e),this.type=t,this.target=n,this.data=r},stringTag="[object String]",objectProto=Object.prototype,objectToString=objectProto.toString,isArray=Array.isArray,index=isString,funcTag="[object Function]",genTag="[object GeneratorFunction]",objectProto$1=Object.prototype,objectToString$1=objectProto$1.toString,index$1=isFunction,index$2=isNil,Emitter=function(){function e(){classCallCheck(this,e),this.suppressEvents=!1}return createClass(e,[{key:"on",value:function(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(index$2(t))throw new Error("Emitter.on requires a String or a RegExp as the first argument");if(!index$1(n))throw new Error("Emitter.on requires a function as the second argument");var o=this.eventMap;return o||(o=e.createEventMap(this)),t instanceof Event&&(t=t.type),o.has(t)||o.set(t,[]),o.get(t).push({func:n,ctx:r,once:!1,removable:i}),this}},{key:"once",value:function(t,n,r){if(index$2(t))throw new Error("Emitter.once requires a String or a RegExp as the first argument");if(!index$1(n))throw new Error("Emitter.once requires a function as the second argument");var i=this.eventMap;return i||(i=e.createEventMap(this)),t instanceof Event&&(t=t.type),i.has(t)||i.set(t,[]),i.get(t).push({func:n,ctx:r,once:!0,removable:!0}),this}},{key:"off",value:function(e,t,n){var r=this.eventMap,i=e;if(!r)return this;if(i instanceof Event&&(i=e.type),r.has(i)||r.set(i,[]),index(e)){var o=r.get(i);o.forEach(function(e,r){e.func===t&&n===e.ctx&&o.splice(r,1)}),0===o.length&&r.delete(i)}else i instanceof RegExp&&r.forEach(function(e,o){o instanceof RegExp&&regexpEqual(i,o)&&(e.forEach(function(r,i){r.func===t&&n===r.ctx&&e.splice(i,1)}),0===e.length&&r.delete(o))});return this}},{key:"emit",value:function(e){var t=this;if(!this.suppressEvents){var n=this.eventMap,r=void 0;if(!n)return this;for(var i=arguments.length,o=Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];r=e instanceof Event?e:new Event(e,this,o);var c=Array.from(o).concat([r]);return n.forEach(function(e,n){(index(r.type)&&n===r.type||index(r.type)&&n instanceof RegExp&&n.test(r.type)||r.type instanceof RegExp&&n instanceof RegExp&&regexpEqual(n,r.type))&&e.forEach(function(e){e.func.apply(e.ctx,c),e.once&&t.off(r.type,e.func,e.ctx)})}),this}}},{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.eventMap,i=e;return r?(index(i)?clearListeners(r,i,t):i instanceof Event?this.clear(i.type,n,t):i instanceof RegExp?Array.from(r).map(function(e){return e[0]}).forEach(function(e){(index(e)&&n&&i.test(e)||e instanceof RegExp&&regexpEqual(e,i))&&clearListeners(r,e,t)}):!0===i?r.clear():!1!==i&&void 0!==i||r.forEach(function(e,t){e.filter(function(e){return e.removable}).forEach(function(t){e.splice(e.indexOf(t),1)}),0===e.length&&r.delete(t)}),this):this}},{key:"count",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.eventMap,r=e;if(!n)return 0;if(index(r))return n.has(r)?n.get(r).length:0;if(r instanceof Event)return n.has(r.type)?n.get(r.type).length:0;if(r instanceof RegExp){var i=0;return n.forEach(function(e,n){index(n)&&t&&r.test(n)?i+=e.length:regexpEqual(n,r)&&(i+=e.length)}),i}var o=0;return n.forEach(function(e,t){o+=e.length}),o}},{key:"eventMap",get:function(){return e.getEventMap(this)}}],[{key:"getEventMap",value:function(e){return(this.events||(this.events=new WeakMap)).get(e)}},{key:"createEventMap",value:function(e){var t=this.events||(this.events=new WeakMap),n=new Map;return t.set(e,n),n}}]),e}();exports.Emitter=Emitter,exports.Event=Event;
//# sourceMappingURL=regexp-events.min.js.map

function clearListeners(e,t,n){if(n)e.delete(t);else{let n=e.get(t);n.filter(e=>e.removable).forEach((e,t)=>{n.splice(n.indexOf(e),1)}),0===n.length&&e.delete(t)}}function regexpEqual(e,t){return e instanceof RegExp&&t instanceof RegExp&&t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode}function isObjectLike(e){return!!e&&"object"==typeof e}function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike(e)&&objectToString.call(e)==stringTag}function isFunction(e){var t=isObject(e)?objectToString$1.call(e):"";return t==funcTag||t==genTag}function isObject(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isNil(e){return null==e}class Event{constructor(e,t,n){this.type=e,this.target=t,this.data=n}}var stringTag="[object String]",objectProto=Object.prototype,objectToString=objectProto.toString,isArray=Array.isArray,index=isString,funcTag="[object Function]",genTag="[object GeneratorFunction]",objectProto$1=Object.prototype,objectToString$1=objectProto$1.toString,index$1=isFunction,index$2=isNil;class Emitter{constructor(){this.suppressEvents=!1}static getEventMap(e){return(this.events||(this.events=new WeakMap)).get(e)}static createEventMap(e){let t=this.events||(this.events=new WeakMap),n=new Map;return t.set(e,n),n}get eventMap(){return Emitter.getEventMap(this)}on(e,t,n,i=!0){if(index$2(e))throw new Error("Emitter.on requires a String or a RegExp as the first argument");if(!index$1(t))throw new Error("Emitter.on requires a function as the second argument");let r=this.eventMap;return r||(r=Emitter.createEventMap(this)),e instanceof Event&&(e=e.type),r.has(e)||r.set(e,[]),r.get(e).push({func:t,ctx:n,once:!1,removable:i}),this}once(e,t,n){if(index$2(e))throw new Error("Emitter.once requires a String or a RegExp as the first argument");if(!index$1(t))throw new Error("Emitter.once requires a function as the second argument");let i=this.eventMap;return i||(i=Emitter.createEventMap(this)),e instanceof Event&&(e=e.type),i.has(e)||i.set(e,[]),i.get(e).push({func:t,ctx:n,once:!0,removable:!0}),this}off(e,t,n){let i=this.eventMap,r=e;if(!i)return this;if(r instanceof Event&&(r=e.type),i.has(r)||i.set(r,[]),index(e)){let e=i.get(r);e.forEach((i,r)=>{i.func===t&&n===i.ctx&&e.splice(r,1)}),0===e.length&&i.delete(r)}else r instanceof RegExp&&i.forEach((e,o)=>{o instanceof RegExp&&regexpEqual(r,o)&&(e.forEach((i,r)=>{i.func===t&&n===i.ctx&&e.splice(r,1)}),0===e.length&&i.delete(o))});return this}emit(e,...t){if(!this.suppressEvents){let n,i=this.eventMap;if(!i)return this;n=e instanceof Event?e:new Event(e,this,t);let r=Array.from(t).concat([n]);return i.forEach((e,t)=>{(index(n.type)&&t===n.type||index(n.type)&&t instanceof RegExp&&t.test(n.type)||n.type instanceof RegExp&&t instanceof RegExp&&regexpEqual(t,n.type))&&e.forEach(e=>{e.func.apply(e.ctx,r);e.once&&this.off(n.type,e.func,e.ctx)})}),this}}clear(e,t=!1,n=!0){let i=this.eventMap,r=e;return i?(index(r)?clearListeners(i,r,t):r instanceof Event?this.clear(r.type,n,t):r instanceof RegExp?Array.from(i).map(e=>e[0]).forEach(e=>{(index(e)&&n&&r.test(e)||e instanceof RegExp&&regexpEqual(e,r))&&clearListeners(i,e,t)}):!0===r?i.clear():!1!==r&&void 0!==r||i.forEach((e,t)=>{e.filter(e=>e.removable).forEach(t=>{e.splice(e.indexOf(t),1)});0===e.length&&i.delete(t)}),this):this}count(e,t=!0){let n=this.eventMap,i=e;if(!n)return 0;if(index(i))return n.has(i)?n.get(i).length:0;if(i instanceof Event)return n.has(i.type)?n.get(i.type).length:0;if(i instanceof RegExp){let e=0;return n.forEach((n,r)=>{index(r)&&t&&i.test(r)?e+=n.length:regexpEqual(r,i)&&(e+=n.length)}),e}{let e=0;return n.forEach((t,n)=>{e+=t.length}),e}}}export{Emitter,Event};
//# sourceMappingURL=regexp-events.es.min.js.map

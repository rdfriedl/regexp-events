/* regexp-events v1.0.2 */
function clearListeners(e,t,n){if(n)e.delete(t);else{let n=e.get(t);n.filter(e=>!e.isStatic).forEach((e,t)=>{n.splice(n.indexOf(e),1)}),0===n.length&&e.delete(t)}}function isRegExpEqual(e,t){return e instanceof RegExp&&t instanceof RegExp&&t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline&&t.sticky===e.sticky&&t.unicode===e.unicode}function isBoolean(e){return!0===e||!1===e}function findInArgArray(e,t,n,r){for(let r=0;r<e.length-n;r++)if(t(e[n+r]))return e[n+r];return r}class Event{constructor(e,t,n){if("string"!=typeof e)throw new Error("Event.type has to be a string");this.type=e,this.args=t||[],this.target=n}}class Emitter{constructor(){this.suppressEvents=!1}static getEventMap(e){return(this.events||(this.events=new WeakMap)).get(e)}static createEventMap(e){let t=this.events||(this.events=new WeakMap),n=new Map;return t.set(e,n),n}static removeEventMap(e){let t=this.events;t&&e&&t.has(e)&&t.delete(e)}get eventMap(){return Emitter.getEventMap(this)}on(e,t,n,r,i){if(!("string"==typeof e||e instanceof RegExp||e instanceof Event))throw new Error("Emitter.on requires a String, Event or RegExp as the first argument");if("function"!=typeof t)throw new Error("Emitter.on requires a function as the second argument");r=findInArgArray(arguments,isBoolean,2,!1),i=findInArgArray(arguments,e=>Number.isFinite(e)||e===1/0,2,1/0),n=findInArgArray(arguments,e=>"object"==typeof e,2,void 0);let s=this.eventMap;return s||(s=Emitter.createEventMap(this)),e instanceof Event&&(e=e.type),s.has(e)||s.set(e,[]),s.get(e).push({func:t,ctx:n,times:i,isStatic:r}),this}once(e,t,n,r){return this.on(e,t,1,n,r)}off(e,t,n,r){if(null==e)throw new Error("Emitter.off requires a String or a RegExp as the first argument");if("function"!=typeof t)throw new Error("Emitter.off requires a function as the second argument");r=findInArgArray(arguments,isBoolean,2,!1),n=findInArgArray(arguments,e=>"object"==typeof e,2,void 0),e instanceof Event&&(e=e.type);let i=this.eventMap;if(!i)return this;if(i.has(e)||i.set(e,[]),"string"==typeof e){let s=i.get(e);s.forEach((e,i)=>{e.func!==t||e.ctx!==n||e.isStatic&&!r||s.splice(i,1)}),0===s.length&&i.delete(e)}else e instanceof RegExp&&i.forEach((s,a)=>{a instanceof RegExp&&isRegExpEqual(e,a)&&(s.forEach((e,i)=>{e.func!==t||e.ctx!==n||e.isStatic&&!r||s.splice(i,1)}),0===s.length&&i.delete(a))});return this}emit(e,...t){if(this.suppressEvents)return;let n,r=this.eventMap;if(!r)return this;if(e instanceof Event)void 0===(n=e).target&&(n.target=this);else{if("string"!=typeof e)throw new Error("Emitter.emit requires a String or Event as the first argument");n=new Event(e,t,this)}let i=Array.from(n.args).concat([n]);return r.forEach((e,t)=>{("string"==typeof n.type&&t===n.type||"string"==typeof n.type&&t instanceof RegExp&&t.test(n.type)||n.type instanceof RegExp&&t instanceof RegExp&&isRegExpEqual(t,n.type))&&e.forEach(e=>{e.func.apply(e.ctx,i),--e.times<=0&&this.off(n.type,e.func,e.ctx,!0)})}),this}clear(e,t=!1,n=!0){let r=this.eventMap;return r?("string"==typeof e?clearListeners(r,e,t):e instanceof Event?clearListeners(r,e.type,t):e instanceof RegExp?Array.from(r).map(e=>e[0]).forEach(i=>{("string"==typeof i&&n&&e.test(i)||i instanceof RegExp&&isRegExpEqual(i,e))&&clearListeners(r,i,t)}):1===arguments.length&&!0===e?r.clear():(!1===e||void 0===e)&&arguments.length<=1&&r.forEach((e,t)=>{e.filter(e=>!e.isStatic).forEach(t=>{e.splice(e.indexOf(t),1)}),0===e.length&&r.delete(t)}),this):this}count(e,t=!0){let n=this.eventMap;if(!n)return 0;if("string"==typeof e)return n.has(e)?n.get(e).length:0;if(e instanceof Event)return n.has(e.type)?n.get(e.type).length:0;if(e instanceof RegExp){let r=0;return n.forEach((n,i)=>{("string"==typeof i&&t&&e.test(i)||i instanceof RegExp&&isRegExpEqual(i,e))&&(r+=n.length)}),r}{let e=0;return n.forEach(t=>{e+=t.length}),e}}dispose(){return Emitter.removeEventMap(this),this}}export{Emitter,Event};
//# sourceMappingURL=regexp-events.es.min.js.map

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">test/Emitter.spec.js | RegExp Events</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="A simple RegExp event emitter"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="RegExp Events"><meta property="twitter:description" content="A simple RegExp event emitter"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/rdfriedl/regexp-events"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Emitter.js~Emitter.html">Emitter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Event.js~Event.html">Event</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-clearListeners">clearListeners</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isRegExpEqual">isRegExpEqual</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">test/Emitter.spec.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { isRegExpEqual } from &quot;../src/utils&quot;;

function expectListenerCount(emitter, type, count, useRegExp = true) {
	expect(emitter).to.exist;
	expect(emitter.eventMap).to.be.an.instanceof(Map);
	if (typeof type === &quot;string&quot;) {
		if (count === 0) {
			expect(emitter.eventMap.size).to.equal(0);
		} else {
			expect(emitter.eventMap.get(type)).to.exist;
			if (emitter.eventMap.get(type)) expect(emitter.eventMap.get(type)).to.have.lengthOf(count);
		}
	} else if (type instanceof RegExp) {
		let total = 0;
		emitter.eventMap.forEach((listeners, listenersEventType) =&gt; {
			if (typeof listenersEventType === &quot;string&quot; &amp;&amp; useRegExp &amp;&amp; type.test(listenersEventType))
				total += listeners.length;
			else if (isRegExpEqual(listenersEventType, type)) total += listeners.length;
		});
		expect(total).to.equal(count);
	} else {
		if (count === 0) {
			expect(emitter.eventMap.size).to.equal(0);
		} else {
			let total = 0;
			emitter.eventMap.forEach(listeners =&gt; (total += listeners.length));
			expect(total).to.equal(count);
		}
	}
}

export default function EmitterTestSuite(Emitter, Event) {
	describe(&quot;Emitter&quot;, function() {
		beforeEach(function() {
			this.emitter = new Emitter();
			this.listener = sinon.stub();
		});

		describe(&quot;on&quot;, function() {
			it(&quot;(String, Function)&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.be.undefined;
				expect(data.isStatic).to.equal(false);
				expect(data.times).to.equal(Infinity);
			});

			it(&quot;(String, Function, context)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, context);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(false);
				expect(data.times).to.equal(Infinity);
			});
			it(&quot;(String, Function, context, times)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, context, 10);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(false);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, context, times, isStatic)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, context, 10, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, context, isStatic)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, context, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(Infinity);
			});
			it(&quot;(String, Function, context, isStatic, times)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, context, true, 10);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});

			it(&quot;(String, Function, isStatic)&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.be.undefined;
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(Infinity);
			});
			it(&quot;(String, Function, isStatic, context)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, true, context);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(Infinity);
			});
			it(&quot;(String, Function, isStatic, times)&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, true, 10);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.be.undefined;
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, isStatic, context, times)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, true, context, 10);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, isStatic, times, context)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, true, 10, context);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});

			it(&quot;(String, Function, times)&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, 10);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.be.undefined;
				expect(data.isStatic).to.equal(false);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, times, context)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, 10, context);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(false);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, times, isStatic)&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, 10, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.be.undefined;
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, times, context, isStatic)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, 10, context, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});
			it(&quot;(String, Function, times, isStatic, context)&quot;, function() {
				let context = {};
				this.emitter.on(&quot;test&quot;, this.listener, 10, true, context);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.ctx).to.equal(context);
				expect(data.isStatic).to.equal(true);
				expect(data.times).to.equal(10);
			});

			it(&quot;(RegExp, Function)&quot;, function() {
				let regexp = /test\d/;
				this.emitter.on(regexp, this.listener);
				expectListenerCount(this.emitter, regexp, 1);

				let data = this.emitter.eventMap.get(regexp)[0];
				expect(data.func).to.equal(this.listener);
			});

			it(&quot;(Event, Function)&quot;, function() {
				this.emitter.on(new Event(&quot;test&quot;), this.listener);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);

				let data = this.emitter.eventMap.get(&quot;test&quot;)[0];
				expect(data.func).to.equal(this.listener);
			});

			it(&quot;() throws if there is no event type&quot;, function() {
				expect(() =&gt; {
					this.emitter.on();
				}).to.throw(Error);
			});

			it(&quot;(Number|Null|Function) throws if the eventType is not a String, Event or RegExp&quot;, function() {
				expect(() =&gt; {
					this.emitter.on(10);
				}).to.throw(Error);

				expect(() =&gt; {
					this.emitter.on(this.listener);
				}).to.throw(Error);

				expect(() =&gt; {
					this.emitter.on(Null);
				}).to.throw(Error);
			});

			it(&quot;(String) throws if listener function is no provided&quot;, function() {
				expect(() =&gt; {
					this.emitter.on(&quot;testing&quot;);
				}).to.throw(Error);
			});

			it(&quot;(String, Null) throws if listener is not a function&quot;, function() {
				expect(() =&gt; {
					this.emitter.on(&quot;testing&quot;, 50);
				}).to.throw(Error);
			});
		});

		describe(&quot;off&quot;, function() {
			it(&quot;only removes the first listener that matches&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.off(&quot;test&quot;, this.listener);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(String, Function) removes listener&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.off(&quot;test&quot;, this.listener);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});
			it(&quot;(String, Function) dose not remove static listener&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.off(&quot;test&quot;, this.listener);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(String, Function, context) removes listener with context&quot;, function() {
				let ctx = {};
				this.emitter.on(&quot;test&quot;, this.listener, ctx);
				this.emitter.off(&quot;test&quot;, this.listener, ctx);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});

			it(&quot;(String, Function) dost not remove listener with different context&quot;, function() {
				let ctx = {};
				let ctx2 = {};
				this.emitter.on(&quot;test&quot;, this.listener, ctx);
				this.emitter.on(&quot;test&quot;, this.listener, ctx2);
				this.emitter.off(&quot;test&quot;, this.listener, ctx);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(Event, Function) removes listener&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.off(new Event(&quot;test&quot;), this.listener);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});

			it(&quot;(RegExp, Function) removes listener&quot;, function() {
				let regexp = /test.*/;
				this.emitter.on(regexp, this.listener);
				this.emitter.off(regexp, this.listener);
				expectListenerCount(this.emitter, regexp, 0);
			});

			it(&quot;(String, Function, force=true) removes static listener&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.off(&quot;test&quot;, this.listener, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});
			it(&quot;(String, Function, force=false) dose not remove static listener&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.off(&quot;test&quot;, this.listener, false);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(String, Function, context, force=true) removes static listener&quot;, function() {
				let ctx = {};
				this.emitter.on(&quot;test&quot;, this.listener, ctx, true);
				this.emitter.off(&quot;test&quot;, this.listener, ctx, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});
			it(&quot;(String, Function, context, force=false) dose not remove static listener&quot;, function() {
				let ctx = {};
				this.emitter.on(&quot;test&quot;, this.listener, ctx, true);
				this.emitter.off(&quot;test&quot;, this.listener, ctx, false);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(String, Function, force=true, context) removes static listener&quot;, function() {
				let ctx = {};
				this.emitter.on(&quot;test&quot;, this.listener, true, ctx);
				this.emitter.off(&quot;test&quot;, this.listener, true, ctx);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});
			it(&quot;(String, Function, force=false, context) dose not remove static listener&quot;, function() {
				let ctx = {};
				this.emitter.on(&quot;test&quot;, this.listener, true, ctx);
				this.emitter.off(&quot;test&quot;, this.listener, false, ctx);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});
		});

		describe(&quot;clear&quot;, function() {
			it(&quot;() removes all listeners&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test2&quot;, this.listener);
				this.emitter.clear();
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
				expectListenerCount(this.emitter, &quot;test2&quot;, 0);
			});

			it(&quot;() dose not remove static listeners&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.clear();
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(force=true) removes static listeners&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.clear(true);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});

			it(&quot;(force=false) dose not remove static listeners&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.clear(false);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(String) removes all listeners of type&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.clear(&quot;test&quot;);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});

			it(&quot;(String, force=true) removes static listeners of type&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.clear(&quot;test&quot;, true);
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});

			it(&quot;(String, force=false) dose not remove static listeners of type&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener, true);
				this.emitter.clear(&quot;test&quot;, false);
				expectListenerCount(this.emitter, &quot;test&quot;, 1);
			});

			it(&quot;(Event) removes all listeners of event type&quot;, function() {
				this.emitter.on(new Event(&quot;test&quot;), this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.clear(new Event(&quot;test&quot;));
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});

			it(&quot;(RegExp) removes listeners with matching String or same RegExp&quot;, function() {
				this.emitter.on(/test\d/, this.listener);
				this.emitter.on(&quot;test10&quot;, this.listener);
				this.emitter.clear(/test\d/);
				expectListenerCount(this.emitter, &quot;test10&quot;, 0);
				expectListenerCount(this.emitter, /test\d/, 0, false);
			});

			it(&quot;(RegExp, force=false, useRegexp=false) only removes matching RegExp&quot;, function() {
				this.emitter.on(/test\d/, this.listener);
				this.emitter.on(&quot;test10&quot;, this.listener);
				this.emitter.clear(/test\d/, false, false);
				expectListenerCount(this.emitter, &quot;test10&quot;, 1);
				expectListenerCount(this.emitter, /test\d/, 0, false);
			});

			it(&quot;(RegExp, force=false, useRegexp=false) takes RegExp flags into account when comparing regexes&quot;, function() {
				this.emitter.on(/test\d/i, this.listener);
				this.emitter.clear(/test\d/, false, false);
				expectListenerCount(this.emitter, /test\d/i, 1, false);
				this.emitter.clear(/test\d/i, false, false);
				expectListenerCount(this.emitter, /test\d/i, 0, false);
			});
		});

		describe(&quot;count&quot;, function() {
			it(&quot;() returns total number of all listeners on the emitter&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test2&quot;, this.listener);
				expect(this.emitter.count()).to.equal(2);
			});

			it(&quot;(String) returns number of listeners of that type&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test2&quot;, this.listener);
				expect(this.emitter.count(&quot;test&quot;)).to.equal(2);
			});

			it(&quot;(Event) returns number of listeners of Event.type&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test2&quot;, this.listener);
				expect(this.emitter.count(new Event(&quot;test&quot;))).to.equal(2);
			});

			it(&quot;(RegExp) returns number of listeners that match the RegExp&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.on(&quot;test2&quot;, this.listener);
				this.emitter.on(&quot;test3&quot;, this.listener);
				this.emitter.on(&quot;test10&quot;, this.listener);
				expect(this.emitter.count(/test\d/)).to.equal(3);
				expect(this.emitter.count(/.*/)).to.equal(5);
			});

			it(&quot;(RegExp, useRegExp=false) returns number of listeners that have a identical RegExp&quot;, function() {
				this.emitter.on(/test\d/g, this.listener);
				this.emitter.on(/test\d/, this.listener);
				this.emitter.on(&quot;test10&quot;, this.listener);
				expect(this.emitter.count(/test\d/, false)).to.equal(1);
				expect(this.emitter.count(/test\d/g, false)).to.equal(1);
			});
		});

		describe(&quot;once&quot;, function() {
			it(&quot;removes listener after the event is fired&quot;, function() {
				this.emitter.once(&quot;test&quot;, this.listener);
				this.emitter.emit(&quot;test&quot;);
				expect(this.listener).to.have.been.called;
				expectListenerCount(this.emitter, &quot;test&quot;, 0);
			});
		});

		describe(&quot;emit&quot;, function() {
			it(&quot;throws error if eventType is not a string&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				expect(() =&gt; {
					this.emitter.emit(null);
				}).to.throw(Error);
			});

			it(&quot;(String) calls listeners&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.emit(&quot;test&quot;);
				expect(this.listener).to.have.been.called;
			});

			it(&quot;(String, args...) calls listeners with arguments&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.emit(&quot;test&quot;, 1, 2, 3);
				expect(this.listener).to.have.been.calledWith(1, 2, 3);
			});

			it(&quot;(String, args...) passes the Event as the last arguments&quot;, function() {
				this.emitter.on(&quot;test&quot;, (...args) =&gt; {
					expect(args[args.length - 1]).to.be.an.instanceof(Event);
				});
				this.emitter.emit(&quot;test&quot;, 1, 2, 3);
			});

			it(&quot;(Event) calls listeners&quot;, function() {
				this.emitter.on(new Event(&quot;test&quot;), this.listener);
				this.emitter.emit(&quot;test&quot;);
				expect(this.listener).to.have.been.called;
			});

			it(&quot;(Event) emits the Event that is passed in&quot;, function() {
				let event = new Event(&quot;test&quot;);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.emit(event);
				expect(this.listener).to.have.been.calledWithExactly(event);
			});

			it(&quot;(Event) calls listeners with Event.args&quot;, function() {
				let event = new Event(&quot;test&quot;, [1, 2, 3]);
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.emit(event);
				expect(this.listener).to.have.been.calledWithExactly(1, 2, 3, event);
			});

			it(&quot;(Event) sets Event.target if its not already set&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);

				let event = new Event(&quot;test&quot;, [1, 2, 3]);
				this.emitter.emit(event);
				expect(event.target).to.equal(this.emitter);

				let target = {};
				event = new Event(&quot;test&quot;, [1, 2, 3], target);
				this.emitter.emit(event);
				expect(event.target).to.equal(target);
			});

			it(&quot;dost not fire the event if Emitter.suppressEvents == true&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener);
				this.emitter.suppressEvents = true;
				this.emitter.emit(&quot;test&quot;);
				expect(this.listener).not.to.have.been.called;
			});

			it(&quot;removes listener after calling is the correct number of times&quot;, function() {
				this.emitter.on(&quot;test&quot;, this.listener, undefined, false, 10);
				for (let i = 0; i &lt; 20; i++) this.emitter.emit(&quot;test&quot;);

				expect(this.listener).to.have.callCount(10);
			});
		});
	});
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.4)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
